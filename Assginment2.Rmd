---
title: "Er det høyde som bestemmer inntekt?"
output:
  pdf_document: default
  html_notebook: default
lang: no-NB
---


```{r}
library(ggplot2)
library(tinytex)
library(tidyverse)
library(modelr)
library(ggpubr)
options(scipen = 999)
```

# Kort innledning

Vi vil i denne oppgaven bruke datasettet ***heights*** for å undersøke
riktigheten av påstanden om at høyde bestemmer inntekt. Undersøkelsen
vil bli gjort gjennom analyser av ulike variabler og ved
regresjonsanalyser. Resultatene vil bli fremstilt i ulike modeller, før
vi vil avslutte med en konklusjon av spørsmålet "er det høyde som
bestemmer inntekt?".

# Litteraturgjennomgang

# Analyse

```{r Hoyde}
hoyde <- heights
```

# Beskrivende statestikk

Se på dette senere.

# EDA

```{r}
#Slett dette senere?
ggplot(data = hoyde)
```

## Lag et histogram av variablen *income*

```{r}
ggplot(data = hoyde, aes(income)) +
  geom_histogram()
```

## Forklaringen på utliggerne langt til høyre

## Personer uten inntekt inkludert i datasettet?

```{r}
sum(hoyde$income == 0)
```

# Regresjonsanalyse

```{r}
hoyde <- heights
```

## Dollar til norske kroner 

```{r}
hoyde <- hoyde %>% 
   mutate(inntekt = income * 8.42)

```


## Redusert datasett

```{r}
hoyde_begr <- hoyde %>%  
  filter(inntekt < 1500000,
         inntekt > 1)
```

```{r}
ggplot(data = hoyde_begr, aes(income)) +
  geom_histogram()
```


## Lag to nye variabler + lag ny variabel bmi

```{r}
hoyde <- hoyde %>% 
  mutate(hoyde_cm = height * 2.54,
         vekt_kg = weight * 0.454,
         BMI = (vekt_kg/hoyde_cm)^2)
```

## Forenklet utgave av variabelen "Martial"

```{r}
hoyde <- hoyde %>% 
mutate(
  married = factor(
    case_when(
      marital == 'married' ~ TRUE,
      TRUE ~ FALSE
      )
    )
  )
```

## minst 6

```{r}
# Denne kan du bare slette, vi har akkurat lik graf lengre oppe.
ggplot(data = hoyde, aes(x = income)) + 
  geom_histogram()
```

```{r}
model1 <- "inntekt ~ hoyde_cm"
lm1 <- lm(model1, data = hoyde, subset = complete.cases(hoyde)) 
```

```{r}
lm(inntekt ~ hoyde_cm, data = hoyde) %>% 
  summary()
```

```{r}
 -1337837.4 + (9884.6 *173)
-1337837.4 + (9884.6 *161)
```

# spørre om hjelp

```{r}
Model2 <- lm
lm(inntekt ~ hoyde_cm + vekt_kg, data = hoyde) %>% 
  summary()
```

```{r}
-697374.7 + (6735.7*173) + (-691.5*70)
```

# Test, kan sikkert bare slettes

```{r}
attach(heights)
summary(income)
histogram(income)
```

# test modeller

```{r}
library(huxtable)
```

```{r}
summary(hoyde_begr)
```


```{r}
Model1 <-lm (income ~ height, data = hoyde)
Model2 <-lm (income ~ height + weight, data = hoyde)
Model3 <-lm (income ~ height + weight + age + sex, data =  hoyde)
```



```{r}
lm1 <-lm (income ~ height, data = hoyde_begr)
lm2 <-lm (income ~ height + weight, data = hoyde_begr)
lm3 <-lm (income ~ height + weight + age + sex, data =  hoyde_begr)
```



```{r}
summary(lm3)
```

```{r}
huxreg(lm1, lm2, lm3)
```

```{r}
huxreg(
lm1, lm2, lm3,
error_format = "[{statistic}]",
note = "{stars}. T statistics in brackets."
)
```

```{r}
heights_eks <- hoyde_begr
```

# spør om denne (riktige variabler?)

```{r}
mdl_1 <- "log(income) ~ sex*height + weight + I(weight^2) + age + I(age^2)"
mdl_1 <- lm(mdl_1, data = heights_eks)
```

```{r}
summary(mdl_1)
```

```{r}
cor(x = heights_eks$sex, y = heights_eks$sex * heights_eks$income, use = 'pairwise.complete.obs')
```

```{r}
library(MASS)
library(hypothesisr)
library(survey)
library(car)
```

```{r}
linearHypothesis(mdl_1, c("female = 0", "female:income = 0"))
```







```{r}
lm1 <-lm (income ~ height, data = hoyde_begr)
lm2 <-lm (income ~ height + weight, data = hoyde_begr)
lm3 <-lm (income ~ height + weight + age + sex, data =  hoyde_begr)
```

